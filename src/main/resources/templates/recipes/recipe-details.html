<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${recipe.title}">Recipe Details</title>
    <link rel="stylesheet" href="/styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-4">
    <h1 th:text="${recipe.title}">Recipe Title</h1>

    <p><strong>Author:</strong> <span th:text="${author.email}"></span></p>
    <p><strong>Difficulty:</strong> <span th:text="${#strings.toLowerCase(recipe.difficulty)}"></span></p>
    <p><strong>Preparation Time:</strong> <span th:text="${recipe.preparationTimeMinutes + ' min'}"></span></p>

    <h4>Categories:</h4>
    <ul>
        <li th:each="cat : ${recipe.mealCategories}"
            th:text="${cat.name}">
        </li>
    </ul>

    <h4>Ingredients:</h4>
    <ul>
        <li th:each="recipeIngredient : ${recipe.ingredients}"
            th:text="${recipeIngredient.amount + ' ' + recipeIngredient.unit.displayName + ' ' + recipeIngredient.ingredient.name}">
            Ingredient
        </li>
    </ul>

    <h4 class="mt-4">Nutrition Facts</h4>
    <div class="card">
        <div class="card-body">
            <p class="text-muted mb-3">
                Calculated from ingredient amounts
                <span th:if="${recipe != null and recipe.servings != null}">
        • Servings: <strong th:text="${recipe.servings}"></strong>
      </span>
            </p>

            <div class="row text-center">
                <div class="col-6 col-md-3 mb-3">
                    <div class="fw-semibold">Energy</div>
                    <div class="display-6 fs-3">
                        <span th:text="${recipe.kcalPerServ ?: '—'}"></span>
                        <span th:if="${recipe.kcalPerServ != null}"> kcal</span>
                    </div>
                </div>

                <div class="col-6 col-md-3 mb-3">
                    <div class="fw-semibold">Protein</div>
                    <div class="display-6 fs-3">
                        <span th:text="${recipe.proteinPerServ ?: '—'}"></span>
                        <span th:if="${recipe.proteinPerServ != null}"> g</span>
                    </div>
                </div>

                <div class="col-6 col-md-3 mb-3">
                    <div class="fw-semibold">Carbs</div>
                    <div class="display-6 fs-3">
                        <span th:text="${recipe.carbsPerServ ?: '—'}"></span>
                        <span th:if="${recipe.carbsPerServ != null}"> g</span>
                    </div>
                </div>

                <div class="col-6 col-md-3 mb-3">
                    <div class="fw-semibold">Fat</div>
                    <div class="display-6 fs-3">
                        <span th:text="${recipe.fatPerServ ?: '—'}"></span>
                        <span th:if="${recipe.fatPerServ != null}"> g</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <h4 class="mt-4">Instructions:</h4>
    <p th:text="${recipe.instructions}">Instructions go here.</p>

    <div th:if="${recipe.image != null}">
        <img th:src="${recipe.image.imageUrl}" class="recipe-detail-image" alt="Recipe Image">
    </div>

    <div class="mt-4">
        <a th:href="${redirectUrl}" class="btn btn-secondary">Back to List</a>

        <a th:if="${currentUserId == author.id}"
           th:href="@{/recipes/edit/{id}(id=${recipe.id})}"
           class="btn btn-primary ms-2">Edit</a>

        <a th:if="${currentUserId == author.id}"
           th:href="@{/recipes/delete/{id}(id=${recipe.id})}"
           class="btn btn-primary ms-2">Delete</a>

        <a th:href="@{/recipes/generate/{id}(id=${recipe.id})}"
           class="btn btn-outline-success ms-2">Download as PDF</a>
    </div>

    <hr class="my-5">

</div>

</body>
</html>
